:root {
  --primary-bg: rgba(255,255,255,0.97);
  --container-img: url('https://www.transparenttextures.com/patterns/pw-maze-white.png');
  --text-main: #333;
  --task-bg: linear-gradient(135deg, #fffefc, #f7f7f7);
  --box-shadow: 0 2px 8px rgba(0,0,0,0.17);
  --btn-bg: #dc3545;
  --btn-hover-bg: #ffd500;
  --btn-color: #fff;
  --btn-hover-color: #000;
  --border: #ccc;
  --border-alt: #ddd;
  --completed-color: #aaa;
  --delete-bg: #dc3545;
  --delete-hover-bg: #a71a1a;
  --delete-color: #fff;
  --logo-color: #000;
}
html,body {
  height: 100vh; margin:0; padding:0; overflow:hidden;
  font-family: Arial, sans-serif; color: var(--text-main);
  background: url('https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=1350&q=80') no-repeat center/cover fixed;
  position:relative;
}
body::before {
  content:"";
  position:fixed; inset:0;
  background:rgba(255,255,255,0.87);
  z-index: -1;
}
.todo-container {
  width: 100%; max-width: 1100px;
  margin:auto;
  height: 100vh;
  background: var(--primary-bg) var(--container-img) repeat;
  border-radius: 8px;
  box-shadow: var(--box-shadow);
  display: flex;
  flex-direction: column;
  padding: 16px 14px 10px;
  box-sizing: border-box;
}
header.header {flex-shrink:0; display:flex; align-items:center; gap:10px; margin-bottom:6px; height:44px;}
.logo svg { width:36px;height:36px;fill:var(--logo-color);}
header h1 {font-size:1.2rem; margin:0; flex-grow:1; user-select:none;}
#dashboardBtn {background: var(--btn-bg); color: var(--btn-color); border:none; border-radius:8px; padding:6px 16px; font-size:1rem; font-weight:700; cursor:pointer; transition:background-color 0.3s;}
#dashboardBtn:hover, #dashboardBtn:focus {background:var(--btn-hover-bg); color:var(--btn-hover-color);}
.controls-row {flex-shrink:0; display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:8px; height:38px; flex-wrap:wrap;}
.controls-row > * {display:flex; align-items:center; gap:10px;}
.controls-row select,#search-tasks {border-radius:6px; border:1px solid var(--border); padding:4px 10px; color:var(--text-main); font-size:1rem;}
#search-tasks{min-width:140px;}
.input-section {flex-shrink:0; display:flex; gap:8px; margin-bottom:8px; height:34px;}
.input-section input[type="text"] {flex:1 1 220px; padding:6px 12px; border-radius:6px; border: 1px solid var(--border);}
.input-section input[type="datetime-local"] {flex:0 0 140px; padding:6px 10px; border-radius:6px; border: 1px solid var(--border);}
.input-section button {flex:0 0 90px; padding:7px 11px; font-size:1rem; font-weight:700; border-radius:8px; border:none; background:var(--btn-bg); color:var(--btn-color);}
.input-section button:hover,.input-section button:focus{background:var(--btn-hover-bg); color:var(--btn-hover-color);}
.columns-container {
  flex-grow:1; display:flex; gap:14px;
  height: calc(100vh - 44px - 38px - 34px - 20px);
  box-sizing: border-box; overflow-x:auto; overflow-y:hidden; flex-wrap:nowrap;
  justify-content: flex-start;
}
.task-column {
  flex: 0 0 320px; height: 100%;
  background: var(--task-bg); border-radius: 8px; border: 1px solid var(--border-alt);
  display: flex; flex-direction: column; padding: 12px 16px 10px; box-sizing: border-box;
}
.task-column h2 {font-size: 1.1rem; font-weight:700; color:var(--text-main); margin:0 0 10px; border-bottom:2px solid var(--border-alt);}
.task-column ul {flex-grow:1; overflow-y:auto; margin:0; padding:0; list-style:none;}
.task-column ul li {display:flex; align-items:flex-start; gap:7px; padding:6px 2px 6px 0; border-bottom:1px solid var(--border-alt); font-size:1rem; cursor:grab;}
.task-column ul li.completed{color:var(--completed-color);}
.task-column ul li.completed span {text-decoration: line-through;}
.task-column ul li span {flex-grow:1; word-break:break-word;margin-top:2px; line-height:1.3;}
.task-column ul li span small {font-size:0.825rem; color:#888;}
.task-column ul li input[type=checkbox]{flex-shrink:0; margin-top:6px; cursor:pointer;}
.task-column ul li button {flex-shrink:0; margin-left:6px; border-radius:6px; padding:5px 10px; font-size:0.9rem; border:none; cursor:pointer;}
.task-column ul li .pin-btn {background:#007bff; color:#fff;}
.task-column ul li .pin-btn:hover, .task-column ul li .pin-btn:focus {background:#0056b3;}
.task-column ul li .edit-btn {background:#888; color:#fff;}
.task-column ul li .edit-btn:hover {background:#ffd500; color:#000;}
.task-column ul li .delete-btn {background:var(--delete-bg); color:var(--delete-color);}
.task-column ul li .delete-btn:hover {background:var(--delete-hover-bg);}
.edit-input {width:100%; font-size:1rem; padding:6px 8px; border-radius:6px; margin-top:2px; border:1px solid #aaa;}
.drop-highlight{outline:2px dashed #666;}
#calendarToggle {position: fixed; top:14px; right:14px; background: var(--btn-bg); color: var(--btn-color); border:none; border-radius:8px; padding:6px 12px; font-size:20px; cursor:pointer; z-index:1001;}
#calendarToggle:hover {background: var(--btn-hover-bg); color: var(--btn-hover-color);}
#calendarPopup {
  position: fixed; top:58px; right:14px; width: 280px; max-width: 90vw;
  background: var(--primary-bg); color: var(--text-main);
  border-radius: 12px; box-shadow: 0 10px 26px rgba(0,0,0,0.22);
  padding: 15px; font-size:14px; display: none; z-index:1100;
}
#calendarPopup h3 {margin:0 0 12px; font-weight:700; text-align:center;}
#dashboardPage h2 {
  font-weight: 900;
  font-size: 2.8rem;
  margin-bottom: 22px;
  letter-spacing: 1.5px;
}
#dashboardStats > div {
  background: var(--btn-bg);
  color: var(--btn-color);
  padding: 18px 0;
  border-radius: 14px;
  font-weight: 800;
  flex: 1 0 120px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
#dashboardStats > div h3 {
  margin: 0;
  font-weight: 900;
  font-size: 2.4rem;
  text-align: center;
}


#calendarPopup table {width:100%; border-collapse:collapse;}
#calendarPopup th, #calendarPopup td {padding:6px; border:1px solid var(--border); text-align:center;}
#calendarPopup td.today {background:var(--btn-bg); color:var(--btn-color); border-radius:50%; font-weight:700;}
#dashboardPage {position:fixed;top:16%;left:50%;transform:translateX(-50%);width:90%;max-width:760px;max-height:70vh;background:var(--primary-bg);border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,0.25);padding:22px 22px 30px; font-size:15px;z-index:1600; display:none;}
#dashboardPage h2{font-weight:800;font-size:2rem; margin-bottom:18px;}
#dashboardStats{display:flex; gap:25px; justify-content:center;}
#dashboardStats>div{background:var(--btn-bg);color:var(--btn-color);padding:18px 0;border-radius:14px;font-weight:800;flex:1 0 120px;}
#dashboardStats>.completed{background:#28a745;}
#dashboardStats>.uncompleted{background:#dc3545;}
#dashboardStats>div p{font-weight:600;font-size:0.9rem;margin-top:8px;}
#dashboardPage #backButton{margin:24px auto 0;padding:10px 24px;font-weight:700;font-size:1.1rem;border-radius:12px;background:var(--btn-bg);border:none;color:var(--btn-color);cursor:pointer;}
#dashboardPage #backButton:hover{background:var(--btn-hover-bg);}
#allTasksDonePopup{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.2);z-index:1700;display:none;align-items:center;justify-content:center;}
#allTasksDonePopup.show{display:flex;}
#allTasksDonePopup>div{background:white;border-radius:14px;box-shadow:0 12px 24px rgba(0,0,0,0.28);padding:28px 30px;max-width:320px;text-align:center;}
#allTasksDonePopup h2{margin:0 0 14px;color:#28a745;font-size:1.4rem;}
#allTasksDonePopup p{margin:0 0 18px;font-size:1.05rem;}
#allTasksDonePopup button{padding:10px 20px;font-size:1rem;border-radius:10px;background:#28a745;color:white;border:none;cursor:pointer;}
#allTasksDonePopup button:hover{background:#218838;}
#confetti {position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;overflow:visible;z-index:1800;}
.confetti-piece{position:absolute;width:8px;height:8px;border-radius:50%;opacity:0.85;animation:confetti-fall 3s ease forwards;}
@keyframes confetti-fall {0%{transform:translateY(0) rotate(0deg); opacity:1;}100%{transform:translateY(320px) rotate(360deg); opacity:0;}}
/* Mobile responsive */
@media (max-width: 750px) {
  .todo-container{max-width:100vw;height:100vh;padding:10px 6px 6px;}
  header.header{height:40px;margin-bottom:6px;}
  header h1{font-size:1.05rem;}
  #dashboardBtn{padding:4px 10px;font-size:0.9rem;}
  .controls-row{height:auto;margin-bottom:8px;gap:7px;justify-content:center;}
  .controls-row > *{flex:1 1 100%;justify-content:center;}
  #search-tasks{min-width:0;width:95%;}
  .input-section{height:34px;}
  .input-section input[type="text"]{flex:1 1 auto;min-width:0;}
  .input-section input[type="datetime-local"]{flex:0 0 110px;}
  .input-section button{flex:0 0 70px;padding:5px 9px;}
  .columns-container{flex-direction:column;overflow-x:hidden;overflow-y:auto;height:calc(100vh - 40px - 66px - 36px);gap:10px;}
  .task-column{flex:1 1 100%;max-height:42vh;min-width:0;width:100%;}
}
/* Theme: dark */
body.theme-dark {
  --primary-bg: #1a1a1d;
  --container-img: none;
  --text-main: #f7f7f7;
  --task-bg: #232323;
  --box-shadow: 0 0 20px rgba(0,0,0,0.7);
  --btn-bg: #ffd500;
  --btn-hover-bg: #dc3545;
  --btn-color: #232323;
  --btn-hover-color: #fff;
  --border: #333;
  --border-alt: #444;
  --completed-color: #8eed8e;
  --delete-bg: #5e132d;
  --delete-hover-bg: #311013;
  --delete-color: #fff;
  --logo-color: #ffd500;
}
body.theme-dark input[type=text],
body.theme-dark input[type=datetime-local],
body.theme-dark select {
  background: #2a2a2c;
  border: 1px solid #555;
  color: #eee;
  opacity: 1;
}
body.theme-blue {
  --primary-bg: #eaf6fb;
  --container-img: none;
  --text-main: #11365d;
  --task-bg: linear-gradient(135deg, #d9ebfc 80%, #e6f1ff 100%);
  --box-shadow: 0 0 20px rgba(50,80,130,0.13);
  --btn-bg: #268aff;
  --btn-hover-bg: #ffd500;
  --btn-color: #fff;
  --btn-hover-color: #268aff;
  --border: #90bfff;
  --border-alt: #7ab0f1;
  --completed-color: #2b6488;
  --delete-bg: #8a041c;
  --delete-hover-bg: #5c214c;
  --delete-color: #fff;
  --logo-color: #258aff;
}
body.theme-blue input[type=text],
body.theme-blue input[type=datetime-local],
body.theme-blue select {
  background: #dae8fb;
  border: 1px solid #7ab0f1;
  color: #0b2546;
  opacity: 1;
}